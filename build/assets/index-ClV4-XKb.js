import{c as Y,a as _,d as H,i as J,A as M,t as B,F as C,az as K,aY as Z,j as e,T as u,I as E,S as ee,B as p,ay as se,aC as ae,n as te,a9 as D,g as re,p as le,N as ne,O as ce,aa as oe,aW as ie,aX as I,U as L,m as de,r as b,V as me,P as xe,C as ue}from"./index-bcifMYEQ.js";import{T as pe}from"./template-item-Cm9rWCaq.js";import{a as je,b as fe,D as he,S as ge,d as ve,e as be,f as T,c as ye}from"./popover-BSl-E8wt.js";import{C as q,T as Ne}from"./column-container-C8j73vUF.js";import{M as Ce}from"./modify-card-D-N1kzU2.js";import{L as ke}from"./list-checks-Cf6GYYLu.js";import"./use-search-params-Bty0Q4Dj.js";import"./text-BZj7_MT7.js";import"./Table-DqxhufFh.js";import"./index-DMQ_vExv.js";import"./index-DazJ7QXT.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=Y("AudioWaveform",[["path",{d:"M2 13a2 2 0 0 0 2-2V7a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0V4a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0v-4a2 2 0 0 1 2-2",key:"57tc96"}]]),Ie=async(r,s)=>{const l=new URLSearchParams;return l.append("workspaceId",s.workspaceId),l.append("projectName",s.projectName),await B.post(`/templates/${r}/apply?${l.toString()}`)},Te=()=>{const r=_();return H({mutationFn:({templateId:s,payload:l})=>Ie(s,l),onSuccess(s){var l;J(s.status)?(M.success("Template applied successfully"),r(`../../../tsm/project/${(l=s==null?void 0:s.data)==null?void 0:l.projectId}?view=project`)):M.error("Failed to apply template")}})},Se=()=>{const[r]=C.useForm(),{templateId:s}=K(),{mutate:l,isPending:m}=Te(),{data:n}=Z(),i=t=>{l({templateId:s,payload:{workspaceId:t.workspaceId,projectName:t.projectName}})};return e.jsxs("div",{className:"flex w-[250px] flex-col gap-y-2",children:[e.jsx(u.Text,{className:"block text-base font-semibold text-center",children:"Apply template"}),e.jsxs(C,{layout:"vertical",onFinish:i,name:"project",form:r,children:[e.jsx(C.Item,{label:"Project name",name:"projectName",children:e.jsx(E,{placeholder:"Graduated thesis"})}),e.jsx(C.Item,{name:"workspaceId",className:"w-full",label:"Workspace",rules:[{required:!0,message:"Please choose workspace"}],children:e.jsx(ee,{showSearch:!0,className:"w-full",allowClear:!0,options:[...(n==null?void 0:n.workspaces)||[],n==null?void 0:n.personalWorkSpace].map(t=>({value:t.id,label:t.name}))})}),e.jsx(C.Item,{name:"description",className:"w-full",label:"Description",children:e.jsx(E.TextArea,{rows:3,placeholder:"Something about your project",allowClear:!0})}),e.jsx("div",{className:"flex items-center float-right w-full gap-x-4",children:e.jsx(p,{loading:m,className:"w-full",type:"primary",htmlType:"submit",children:"Apply"})})]})]})},Ae=async r=>{const{data:s}=await B.get(`/templates/${r}`);return s},U=()=>{const{templateId:r}=K(),{queryKey:s}=Pe(r);return se({queryKey:s,queryFn:()=>Ae(r)})};function Pe(r){return{queryKey:["tsm/template/detail",r]}}const Re=({context:r="USER"})=>{var t;const{data:s,isLoading:l}=U(),{data:m,isLoading:n}=ae(),{btnColor:i}=te(j=>j.theme);return e.jsxs("div",{className:"flex flex-col gap-y-4 px-8 pb-20",children:[e.jsx("div",{className:"flex items-center justify-between",children:l?e.jsx(D,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-x-6",children:[e.jsx("div",{className:"rounded bg-white",children:e.jsx(re,{type:"SINGLE_LOGO",size:"w-16 h-16"})}),e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsx(u.Text,{className:"text-xl font-semibold",children:s==null?void 0:s.name}),e.jsxs(u.Text,{className:"block text-xs font-normal",children:["by ",e.jsx("span",{className:"font-semibold text-primary-default",children:"Tasksmart"})," team"]}),e.jsx(u.Text,{className:"block text-xs font-normal",children:"@Double2D Corp"})]})," "]}),r==="USER"&&e.jsx(le,{trigger:"click",placement:"leftBottom",content:e.jsx(Se,{}),children:e.jsx(p,{style:{backgroundColor:i,color:"white"},size:"large",type:"primary",icon:e.jsx(we,{className:"flex items-center",size:"14"}),children:"Use template"})})]})}),e.jsx(ne,{className:"my-[1px]"}),e.jsxs("div",{className:"my-2",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-x-4",children:[e.jsx("span",{className:"h-7 w-[6px] bg-primary-default"}),e.jsxs(u.Text,{className:"block text-lg font-semibold",children:[" ","About this template"]})]}),e.jsx(u.Text,{className:"block text-sm font-normal",children:"This template provides a centralized space for every new hire to tackle all the job-related logistical items and business requirements to get onboarded."}),e.jsx("br",{}),e.jsx(u.Text,{className:"block text-sm font-normal",children:s==null?void 0:s.description})]}),e.jsxs("section",{className:"relative mx-auto h-[600px] w-[calc(100vw-400px)]  rounded-lg bg-cover bg-center bg-no-repeat",style:{backgroundPosition:"center",backgroundImage:`url(${(t=s==null?void 0:s.image.urls)==null?void 0:t.full})`},children:[e.jsx("div",{className:"absolute inset-0 rounded-lg bg-black bg-opacity-40"}),e.jsxs("div",{className:"flex items-start gap-x-2",children:[e.jsx("div",{children:e.jsx(ce,{tabBarGutter:20,className:"custom-tabs-template mb-0 w-[calc(100vw-400px)] text-white",items:[{key:"project",label:"Project",children:e.jsx(ze,{})},{key:"Kaban",label:"Kaban",children:e.jsx("div",{className:"px-6",children:"Overview"})}],tabBarExtraContent:{left:e.jsx("div",{className:"mr-8 flex items-center",children:l?e.jsx(D,{}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mr-4 max-w-48 truncate text-[18px] font-bold",children:s==null?void 0:s.name}),e.jsx(oe,{color:i,children:"Template"})]})})}})}),e.jsxs("div",{className:"absolute right-6 top-[10px] flex items-center gap-x-4 rounded-lg",children:[e.jsx(p,{size:"middle",style:{color:i},className:"flex items-center",type:"default",icon:e.jsx(ie,{size:"14",style:{color:i}}),children:"Search"}),e.jsx(p,{style:{backgroundColor:i,color:"white"},size:"middle",className:"flex items-center gap-x-2",icon:e.jsx(ke,{size:"14"}),children:"Add task"}),e.jsxs(I.Group,{maxCount:2,className:"flex items-center",children:[e.jsx(I,{style:{backgroundColor:"#f56a00"},icon:e.jsx(L,{size:"12"})}),e.jsx(I,{style:{backgroundColor:"#7265e6"},icon:e.jsx(L,{size:"12"})}),e.jsx(I,{style:{backgroundColor:"#ffbf00"},icon:e.jsx(L,{size:"12"})})]})]})]})]}),e.jsxs("div",{className:"mb-6 flex items-center gap-x-4",children:[e.jsx("span",{className:"h-7 w-[6px] bg-primary-default"}),e.jsxs(u.Text,{className:"block text-lg font-semibold",children:[" ","Relative templates"]})]}),n?e.jsxs("div",{className:"flex items-center justify-center",children:[" ",e.jsx(D,{})]}):e.jsx("div",{className:"mx-auto grid grid-cols-3 gap-6",children:m==null?void 0:m.map((j,y)=>e.jsx(pe,{template:j},y))})]})},ze=()=>{const r=je(fe(ye,{activationConstraint:{distance:10}})),[s,l]=de(!1),m=a=>{l(a)},[n,i]=b.useState([]),[t,j]=b.useState([]),[y,O]=b.useState(null),[F,G]=b.useState(null),{data:d,isLoading:R}=U(),V=b.useMemo(()=>n.map(a=>a.id),[n]);b.useEffect(()=>{const a=[];d==null||d.project.listCards.forEach(c=>{c.cards.forEach(o=>{a.push({...o,listCardId:c.id})})}),d!=null&&d.project.listCards&&i(d==null?void 0:d.project.listCards),j(a)},[d]);const S=a=>{j(a)},W=a=>{i(a)};return e.jsxs("div",{children:[e.jsxs(he,{sensors:r,onDragStart:$,onDragEnd:Q,onDragOver:X,children:[R?e.jsx(me.Page,{size:"full"}):e.jsx("div",{className:"inline-block min-h-screen px-6 ",children:e.jsxs("div",{className:"flex items-start gap-x-3",children:[e.jsx(ge,{items:V,children:n.map(a=>e.jsx(q,{column:a,cards:t.filter(c=>c.listCardId===a.id)},a.id))}),e.jsx(ve,{visible:s,onOpenChange:m,content:e.jsxs("div",{className:"flex w-[250px] flex-col gap-4",children:[e.jsx(E,{placeholder:"Enter list title",allowClear:!0,size:"large",className:"rounded text-sm font-semibold "}),e.jsxs("div",{className:"ml-auto flex items-center gap-x-2",children:[e.jsx(p,{type:"primary",className:"rounded text-xs font-semibold ",children:"Add list"}),e.jsx(p,{type:"default",className:"w-16 rounded text-xs font-semibold",children:"Cancel"})]})]}),children:e.jsx(p,{icon:e.jsx(xe,{className:"h-4 w-4 opacity-65"}),size:"large",className:"flex w-[275px] items-center rounded-xl border-none bg-[#ffffff3d] text-sm font-semibold text-white",children:"Add new list"})})]})}),ue.createPortal(e.jsxs(be,{children:[y&&e.jsx(q,{column:y,cards:t.filter(a=>a.listCardId===y.id)}),F&&e.jsx(Ne,{card:F})]}),document.body)]}),e.jsx(Ce,{members:[]})]});function $(a){var c,o;if(((c=a.active.data.current)==null?void 0:c.type)==="Column"){O(a.active.data.current.column);return}if(((o=a.active.data.current)==null?void 0:o.type)==="Task"){G(a.active.data.current.task);return}}function Q(a){var N;O(null),G(null);const{active:c,over:o}=a;if(!o)return;const f=c.id,h=o.id;if(f===h||!(((N=c.data.current)==null?void 0:N.type)==="Column"))return;const A=n.findIndex(g=>g.id===f),P=n.findIndex(g=>g.id===h),w=T(n,A,P);W(w)}function X(a){var w,N,g;const{active:c,over:o}=a;if(!o)return;const f=c.id,h=o.id;if(f===h)return;const k=((w=c.data.current)==null?void 0:w.type)==="Task",A=((N=o.data.current)==null?void 0:N.type)==="Task";if(!k)return;if(k&&A){const x=t.findIndex(z=>z.id===f),v=t.findIndex(z=>z.id===h);t[x].listCardId!=t[v].listCardId&&(t[x].listCardId=t[v].listCardId,S(T(t,x,v-1))),S(T(t,x,v))}const P=((g=o.data.current)==null?void 0:g.type)==="Column";if(k&&P){const x=t.findIndex(v=>v.id===f);t[x].listCardId=h.toString(),S(T(t,x,x))}}};export{Re as default};
